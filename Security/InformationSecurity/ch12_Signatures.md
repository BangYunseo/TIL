# Chapter 11. μ„λ…(Signatures)

> 1μ . λ””μ§€ν„Έ μ„λ…(Digital Signatures)
>
> 2μ . RSA μ„λ…
>
> 3μ . DSS / DSA
>
> 4μ . 0-μ§€μ‹ μ¦λ…(Zero-Knowledge Proof)
>
> 5μ . Schnorr

## 1μ . λ””μ§€ν„Έ μ„λ…(Digital Signatures)

#### λ””μ§€ν„Έ μ„λ…(Digital Signatures) μ •μ

- λ””μ§€ν„Έ λ©”μ‹μ§€λ‚ λ¬Έμ„μ μ§„μ„λ¥Ό μ¦λ…ν•λ” μν•™μ  λ°©μ‹
- μΈμ¦ λ° λ¶€μΈ λ°©μ§€
  - μ ν¨ν• λ””μ§€ν„Έ μ„λ…μ— λ€ν• μμ‹ μμ™€ λ°μ‹ μμ μ •λ³΄
    - μμ‹ μ : λ©”μ‹μ§€κ°€ λ°μ‹ μμ— μν•΄ μƒμ„±λμ—μμ„ λ―Ώμ„ μ μλ” μ΄μ  μ κ³µ
    - λ°μ‹ μ : λ©”μ‹μ§€λ¥Ό λ³΄λ‚Έ μ‚¬μ‹¤μ„ λ¶€μΈ λ¶κ°€
- λ¬΄κ²°μ„±
  - λ©”μ‹μ§€κ°€ μ „μ†΅ μ¤‘μ— λ³€κ²½λμ§€ μ•μμ„ λ³΄μ¥

#### λ””μ§€ν„Έ μ„λ…(Digital Signatures) μ•κ³ λ¦¬μ¦

##### ν‚¤ μƒμ„± μ•κ³ λ¦¬μ¦(Key Generation Algorithm)

- λ¬΄μ‘μ„ μ•κ³ λ¦¬μ¦
- $(pk, sk)$ μ¶λ ¥

##### μ„λ… μ•κ³ λ¦¬μ¦(Signing Algorithm)

- κ°μΈ ν‚¤μ™€ λ©”μ‹μ§€λ¥Ό λ°›μ•„ μ„λ… μ¶λ ¥
- $s = Sign(sk, m)$

##### κ²€μ¦ μ•κ³ λ¦¬μ¦(Verification Algorithm)

- κ³µκ° ν‚¤, λ©”μ‹μ§€, μ„λ… μ…λ ¥
- λ©”μ‹μ§€μ μ§„μ„ μ£Όμ¥μ— μλ½ or κ±°λ¶€
- $Vrfy(pk, m, s) = Y/N$

#### μΌλ°μ μΈ λ””μ§€ν„Έ μ„λ… κ³Όμ •

![DSP](https://github.com/BangYunseo/TIL/blob/main/Security/InformationSecurity/Image/ch12/DSP.PNG)

## 2μ . RSA μ„λ…

#### RSA μ„λ… (ν•΄μ‰¬λ RSA λλ” FDH-RSA) μ•κ³ λ¦¬μ¦

##### ν‚¤ μƒμ„± μ•κ³ λ¦¬μ¦

- RSA μ•”νΈν™”μ™€ λ™μΌ
- κ³µκ° ν‚¤ = $(e, n)$
- κ°μΈ ν‚¤ = $(d, n)$

##### μ„λ… μ•κ³ λ¦¬μ¦

- μ…λ ¥
  - κ°μΈ ν‚¤ = $(d, n)$
  - λ©”μ‹μ§€ = $m$
- μ„λ… $s = H(m)^d$ $mod$ $n$ κ³„μ‚°
- $H : {0, 1}^* β†’ Z_n^*$λ” μ•”νΈν•™μ  ν•΄μ‰¬ ν•¨μ

##### κ²€μ¦ μ•κ³ λ¦¬μ¦

- μ…λ ¥
  - κ³µκ° ν‚¤ = $(e, n)$
  - λ©”μ‹μ§€ = $m$
  - μ„λ… = $s$
- $H(m) = s^e$ $mod$ $n$ ν™•μΈ

##### λ²μ™Έ) RSA μ„λ…μ—λ§ ν•΄λ‹Ήλλ” μ΅°κ±΄

- μ„λ…(Sign) = κ°μΈ ν‚¤λ΅ μ•”νΈν™”
- κ²€μ¦(Vrfy) = κ³µκ° ν‚¤λ΅ λ³µνΈν™”

#### RSA-PSS(Probabilistic Signature Scheme)

![PSS](https://github.com/BangYunseo/TIL/blob/main/Security/InformationSecurity/Image/ch12/PSS.PNG)

## 3μ . DSS / DSA

#### λ””μ§€ν„Έ μ„λ… ν‘μ¤€(DSS : Digital Signature Standard)

- λ””μ§€ν„Έ μ„λ…μ„ μƒμ„±ν•κΈ° μ„ν• μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ μ„¤λ…ν•λ” λ―Έκµ­ μ •λ¶€μ FIPS(μ—°λ°© μ •λ³΄ μ²λ¦¬ ν‘μ¤€) 186
- μ΄ λ„¤ λ²μ κ°μ •ν
  - FIPS 186-1 (1996)
  - FIPS 186-2 (2000)
  - FIPS 186-3 (2009)
    - DSA, RSA λ° EC-DSA ν¬ν•¨
  - FIPS 186-4 (2013)

#### DSA(Digital Signature Algorithm)

##### λ””μ§€ν„Έ μ„λ… μ•κ³ λ¦¬μ¦(DSA) μ•κ³ λ¦¬μ¦

- λ§¤κ°λ³€μ : $(p, q, g)$

- ν‚¤ μƒμ„± μ•κ³ λ¦¬μ¦

  - $0 < x < q$ λ²”μ„μ—μ„ λ¬΄μ‘μ„ λ°©λ²•μΌλ΅ λΉ„λ°€ ν‚¤ $x$ μ„ νƒ
  - κ³µκ° ν‚¤ $y = g^x$ $mod$ $p$ κ³„μ‚°

- μ„λ… μ•κ³ λ¦¬μ¦

  - $0 < k < q$ λ²”μ„μ—μ„ λ©”μ‹μ§€ λ³„ λ¬΄μ‘μ„ κ°’ $k$ μƒμ„±
  - $r = (g^k mod$ $p)$ $mod$ $q$μ™€ $s = k^β’1(H(m) + xr)$ $mod$ $q$ κ³„μ‚°
  - λ©”μ‹μ§€ $m$μ— λ€ν• μ„λ… : $(r, s)$

- κ²€μ¦ μ•κ³ λ¦¬μ¦
  - $w = s^{β’1}$ $mod$ $q, u_1 = H(m)w$ $mod$ $q, u_2 = rw$ $mod$ $q$ κ³„μ‚°
  - $v = (g^{u_1} y^{u_2}$ $mod$ $p)$ $mod$ $q$ κ³„μ‚°
  - μ„λ… μ ν¨μ„± : $v = r$

## 4μ . 0-μ§€μ‹ μ¦λ…(Zero-Knowledge Proof)

#### ZKP

- μ λ΅-μ§€μ‹ μ¦λ…(Zero-Knowledge Proof)
- μ λ΅-μ§€μ‹ ν”„λ΅ν† μ½
- ν• λ‹Ήμ‚¬μ(μ¦λ…μ Peggy)κ°€ λ‹¤λ¥Έ λ‹Ήμ‚¬μ(κ²€μ¦μ Victor)μ—κ² νΉμ • κ°’ $x$λ¥Ό μ•κ³  μμ μ¦λ…
- ν•΄λ‹Ή κ°’ $x$λ¥Ό μ•κ³  μλ‹¤λ” μ‚¬μ‹¤ μ™Έ μ–΄λ– ν• μ •λ³΄λ„ μ „λ‹¬ν•μ§€ μ•λ” λ°©λ²•

#### μ†μ„±

- μ™„μ „μ„±(Completeness)

  - λ…μ κ°€ μ°ΈμΌ κ²½μ°
    - μ •μ§ν• μ¦λ…μκ°€ μ •μ§ν• κ²€μ¦μμ—κ² μ‚¬μ‹¤ λ‚©λ“

- κ±΄μ „μ„±(Soundness)

  - λ…μ κ°€ κ±°μ§“μΌ κ²½μ°
    - λ¶€μ •μ§ν• μ¦λ…μκ°€ μ •μ§ν• κ²€μ¦μμ—κ² κ·Έκ²ƒμ΄ μ°Έμ΄λΌκ³  λ‚©λ“μ‹ν‚¬ ν™•λ¥  λ§¤μ° λ‚®μ

- μ λ΅-μ§€μ‹(Zero-knowledge)

  - λ…μ κ°€ μ°ΈμΌ κ²½μ°
    - κ²€μ¦μλ” λ…μ κ°€ μ°Έμ΄λΌλ” μ‚¬μ‹¤ μ™Έμ— μ•„λ¬΄κ²ƒλ„ μ• μ μ—†μ

#### μμ‹

- λ£¨λΉ… νλΈ(Rubik Cube)

![RC](https://github.com/BangYunseo/TIL/blob/main/Security/InformationSecurity/Image/ch12/RC.PNG)

- ν• λ΅μ μ‚¬νƒ•(Halloween Candy)

![HC](https://github.com/BangYunseo/TIL/blob/main/Security/InformationSecurity/Image/ch12/HC.PNG)

- μ•λ¦¬λ°”λ°” λ™κµ΄(AliBaba Cave)

![AC](https://github.com/BangYunseo/TIL/blob/main/Security/InformationSecurity/Image/ch12/AC.PNG)

## 5μ . Schnorr

#### μλ…Έλ¥΄ μ‹λ³„(Schnorr Identification)

![SA](https://github.com/BangYunseo/TIL/blob/main/Security/InformationSecurity/Image/ch12/SA.PNG)

- νΉλ³„ μ •μ§-κ²€μ¦μ μ λ΅-μ§€μ‹

  - $(r, e, s)$λ” $x$λ¥Ό μ•μ§€ μ•κ³ λ„ μ‹λ®¬λ μ΄μ… κ°€λ¥

- νΉλ³„ κ±΄μ „μ„±
  β€“ $e1 β‰  e2$μΌ λ•, $(r, e_1, s_1)$κ³Ό $(r, e_2, s_2)$λ΅λ¶€ν„° $x$ κ³„μ‚° κ°€λ¥

#### μλ…Έλ¥΄ μ„λ…(Schnorr Signature)

- λ§¤κ°λ³€μ : $(p, q, g)$

- ν‚¤ μƒμ„± μ•κ³ λ¦¬μ¦

  - $0 < x < q$ λ²”μ„μ—μ„ λ¬΄μ‘μ„ λ°©λ²•μΌλ΅ λΉ„λ°€ν‚¤ $x$ μ„ νƒ
  - κ³µκ°ν‚¤ $y$λ¥Ό $y = g^x$ $mod$ $p$λ΅ κ³„μ‚°

- μ„λ… μ•κ³ λ¦¬μ¦

  - λ©”μ‹μ§€λ§λ‹¤ κ³ μ ν• λ¬΄μ‘μ„ κ°’ $k$λ¥Ό $0 < k < q$ λ²”μ„μ—μ„ μƒμ„±
  - $r = g^k$ $mod$ $p,$ $e = H(r,m), s=kβ’xe$ $mod$ $q$ κ³„μ‚°
  - λ©”μ‹μ§€ $m$μ— λ€ν• μ„λ… : $(s, e)$

- κ²€μ¦ μ•κ³ λ¦¬μ¦
  - $π‘Μ‚ = g^sy^e$ $mod$ $p$ κ³Ό $π‘’Μ‚ = H(π‘Μ‚, m)$ κ³„μ‚°
  - μ„λ…μ€ $π‘’Μ‚ = e$μΌ λ• μ ν¨
